#this script is used to find the tickers tickers which are either trading in a range
#or is trading with lower than usual trading volume 

import matplotlib.pyplot as plt
import math
import numpy as np
from time_series_frmdb import make_time_series #here you can use yfinance incase you are using this for USA stocks
import pandas as pd
from finta import TA
from matplotlib.pyplot import figure
import openpyxl
import datetime as dt
# add the tickers which you need to analyze, here I'm cosidering only NSE listed stocks
ticker_lis = ['40MICRONS','21STCENMGM','3MINDIA','3PLAND','5PAISA','63MOONS','A2ZINFRA','AAKASH','AAREYDRUGS','AARON','AARTIDRUGS','AARTIIND','AARTISURF','AARVEEDEN','AARVI','AAVAS','ABB','ABBOTINDIA','ABCAPITAL','ABFRL','ABMINTLLTD','ABSLAMC','ABSLBANETF','ABSLNN50ET','ACC','ACCELYA','ACCURACY','ACE','ACRYSIL','ADANIENT','ADANIGREEN','ADANIPORTS','ADANIPOWER','ADFFOODS','ADORWELD','ADROITINFO','ADSL','ADVANIHOTR','ADVENZYMES','AEGISCHEM','AFFLE','AGARIND','AGROPHOS','AHLADA','AHLEAST','AHLUCONT','AIAENG','AIRAN','AIROLAM','AJANTPHARM','AJOONI','AJRINFRA','AKASH','AKG','AKSHARCHEM','AKSHOPTFBR','AKZOINDIA','ALANKIT','ALBERTDAVD','ALEMBICLTD','ALICON','ALKALI','ALKEM','ALKYLAMINE','ALLCARGO','ALLSEC','ALMONDZ','ALOKINDS','ALPA','ALPHAGEO','AMARAJABAT','AMBER','AMBICAAGAR','AMBIKCO','AMBUJACEM','AMDIND','AMIORG','AMJLAND','AMRUTANJAN','ANDHRACEMT','ANDHRAPAP','ANDHRSUGAR','ANDREWYU','ANGELBRKG','ANIKINDS','ANKITMETAL','ANMOL','ANSALAPI','ANSALHSG','ANUP','ANURAS','APARINDS','APCL','APCOTEXIND','APEX','APLAPOLLO','APLLTD','APOLLO','APOLLOHOSP','APOLLOPIPE','APOLLOTYRE','APOLSINHOT','APTECHT','APTUS','ARCHIDPLY','ARCHIES','ARENTERP','ARIES','ARIHANT','ARIHANTCAP','ARIHANTSUP','ARMANFIN','AROGRANITE','ARROWGREEN','ARSHIYA','ARSSINFRA','ARTEMISMED','ARTNIRMAN','ARVEE','ARVIND','ARVINDFASN','ASAHIINDIA','ASAHISONG','ASAL','ASALCBR','ASHAPURMIN','ASHIANA','ASHIMASYN','ASHOKA','ASHOKLEY','ASIANHOTNR','ASIANPAINT','ASIANTILES','ASPINWALL','ASTEC','ASTERDM','ASTRAL','ASTRAMICRO','ASTRAZEN','ASTRON','ATFL','ATLANTA','ATUL','ATULAUTO','AUBANK','AURIONPRO','AUROPHARMA','AUSOMENT','AUTOAXLES','AUTOIND','AVADHSUGAR','AVANTIFEED','AVTNPL','AWHCL','AXISBANK','AXISBNKETF','AXISBPSETF','AXISCADES','AXISCETF','AXISGOLD','AXISHCETF','AXISNIFTY','AXISTECETF','AYMSYNTEX','BAFNAPH','BAJAJ-AUTO','BAJAJCON','BAJAJELEC','BAJAJFINSV','BAJAJHIND','BAJAJHLDNG','BAJFINANCE','BALAJITELE','BALAMINES','BALAXI','BALKRISHNA','BALKRISIND','BALMLAWRIE','BALPHARMA','BALRAMCHIN','BANARBEADS','BANARISUG','BANCOINDIA','BANDHANBNK','BANG','BANKA','BANKBARODA','BANKBEES','BANKINDIA','BANSWRAS','BARBEQUE','BASF','BASML','BATAINDIA','BAYERCROP','BBL','BBTC','BCG','BCLIND','BCP','BDL','BEARDSELL','BECTORFOOD','BEDMUTHA','BEL','BEML','BEPL','BERGEPAINT','BESTAGRO','BFINVEST','BFUTILITIE','BGRENERGY','BHAGCHEM','BHAGERIA','BHAGYANGR','BHAGYAPROP','BHANDARI','BHARATFORG','BHARATGEAR','BHARATRAS','BHARATWIRE','BHARTIARTL','BHEL','BIGBLOC','BIL','BINDALAGRO','BIOCON','BIOFILCHEM','BIRLACABLE','BIRLACORPN','BIRLAMONEY','BIRLATYRE','BLBLIMITED','BLISSGVS','BLKASHYAP','BLUEDART','BLUESTARCO','BODALCHEM','BOMDYEING','BOROLTD','BORORENEW','BOSCHLTD','BPCL','BRFL','BRIGADE','BRITANNIA','BRNL','BROOKS','BSE','BSHSL','BSL','BSLGOLDETF','BSLNIFTY','BSLSENETFG','BSOFT','BURGERKING','BYKE','CADILAHC','CAMLINFINE','CAMS','CANBK','CANFINHOME','CAPACITE','CAPLIPOINT','CAPTRUST','CARBORUNIV','CAREERP','CARERATING','CARTRADE','CASTROLIND','CCHHL','CCL','CEATLTD','CEBBCO','CELEBRITY','CENTENKA','CENTEXT','CENTRALBK','CENTRUM','CENTUM','CENTURYPLY','CENTURYTEX','CERA','CEREBRAINT','CESC','CGCL','CHALET','CHAMBLFERT','CHEMBOND','CHEMCON','CHEMFAB','CHEMPLASTS','CHENNPETRO','CHOLAFIN','CHOLAHLDNG','CIGNITITEC','CINELINE','CINEVISTA','CIPLA','CLEAN','CLNINDIA','CLSEL','CMICABLES','COALINDIA','COASTCORP','COCHINSHIP','COFFEEDAY','COFORGE','COLPAL','COMPINFO','COMPUSOFT','CONCOR','CONFIPET','CONSOFINVT','CONTROLPR','CORALFINAC','CORDSCABLE','COROMANDEL','COSMOFILMS','COUNCODOS','CPSEETF','CRAFTSMAN','CREATIVE','CREDITACC','CREST','CRISIL','CROMPTON','CSBBANK','CTE','CUB','CUBEXTUB','CUMMINSIND','CUPID','CYBERMEDIA','CYBERTECH','CYIENT','DAAWAT','DABUR','DALBHARAT','DALMIASUG','DAMODARIND','DANGEE','DATAMATICS','DBCORP','DBL','DBREALTY','DBSTOCKBRO','DCAL','DCBBANK','DCM','DCMFINSERV','DCMNVL','DCMSHRIRAM','DECCANCE','DEEPAKFERT','DEEPAKNTR','DEEPENR','DEEPINDS','DELPHIFX','DELTACORP','DELTAMAGNT','DEN','DENORA','DEVYANI','DFMFOODS','DGCONTENT','DHAMPURSUG','DHANBANK','DHANI','DHANUKA','DHARSUGAR','DHUNINV','DIAMONDYD','DICIND','DIVISLAB','DIXON','DLF','DLINKINDIA','DMART','DNAMEDIA','DODLA','DOLAT','DOLLAR','DONEAR','DPABHUSHAN','DPSCLTD','DPWIRES','DREDGECORP','DRREDDY','DSSL','DTIL','DUCON','DVL','DWARKESH','DYNPRO','EASTSILK','EBANK','EBBETF0423','EBBETF0425','EBBETF0430','EBBETF0431','ECLERX','EDELWEISS','EICHERMOT','EIDPARRY','EIFFL','EIHAHOTELS','EIHOTEL','EIMCOELECO','EKC','ELECON','ELECTCAST','ELECTHERM','ELGIEQUIP','ELGIRUBCO','EMAMILTD','EMAMIPAP','EMAMIREAL','EMKAY','EMMBI','ENDURANCE','ENERGYDEV','ENGINERSIN','ENIL','EPL','EQUITAS','EQUITASBNK','ERIS','EROSMEDIA','ESABINDIA','ESCORTS','ESSARSHPNG','ESTER','EVEREADY','EVERESTIND','EXCEL','EXCELINDUS','EXIDEIND','EXXARO','FACT','FAIRCHEMOR','FCL','FCONSUMER','FCSSOFT','FDC','FEDERALBNK','FEL','FELDVR','FIEMIND','FILATEX','FINCABLES','FINEORG','FINPIPE','FLEXITUFF','FLFL','FLUOROCHEM','FMGOETZE','FMNL','FORCEMOT','FORTIS','FOSECOIND','FRETAIL','FSC','FSL','GABRIEL','GAEL','GAIL','GAL','GALAXYSURF','GALLANTT','GALLISPAT','GANDHITUBE','GANECOS','GANESHBE','GANESHHOUC','GANGAFORGE','GANGESSECU','GARFIBRES','GATI','GAYAPROJ','GDL','GEECEE','GEEKAYWIRE','GENCON','GENESYS','GENUSPAPER','GENUSPOWER','GEOJITFSL','GEPIL','GESHIP','GET&D','GFLLIMITED','GHCL','GICHSGFIN','GICRE','GILLANDERS','GILLETTE','GINNIFILA','GIPCL','GKWLIMITED','GLAND','GLAXO','GLENMARK','GLFL','GLOBAL','GLOBALVECT','GLOBE','GLOBUSSPR','GLS','GMBREW','GMDCLTD','GMMPFAUDLR','GMRINFRA','GNA','GNFC','GOACARBON','GOCLCORP','GODFRYPHLP','GODREJAGRO','GODREJCP','GODREJIND','GODREJPROP','GOKEX','GOKUL','GOKULAGRO','GOLDBEES','GOLDIAM','GOLDSHARE','GOODLUCK','GOODYEAR','GPIL','GPPL','GPTINFRA','GRANULES','GRAPHITE','GRASIM','GRAUWEIL','GRAVITA','GREAVESCOT','GREENLAM','GREENPANEL','GREENPLY','GRINDWELL','GRINFRA','GROBTEA','GRPLTD','GRSE','GSCLCEMENT','GSFC','GSPL','GSS','GTL','GTNTEX','GTPL','GUFICBIO','GUJALKALI','GUJAPOLLO','GUJGASLTD','GULFOILLUB','GULFPETRO','GULPOLY','HAL','HARRMALAYA','HATHWAY','HATSUN','HAVELLS','HBANKETF','HBLPOWER','HBSL','HCC','HCG','HCL-INSYS','HCLTECH','HDFC','HDFCAMC','HDFCBANK','HDFCLIFE','HDFCMFGETF','HDFCNIFETF','HDFCSENETF','HEG','HEIDELBERG','HEMIPROP','HERANBA','HERCULES','HERITGFOOD','HEROMOTOCO','HESTERBIO','HFCL','HGINFRA','HIKAL','HIL','HILTON','HINDALCO','HINDCOMPOS','HINDCON','HINDCOPPER','HINDNATGLS','HINDOILEXP','HINDPETRO','HINDUNILVR','HINDZINC','HIRECT','HISARMETAL','HITECH','HITECHCORP','HITECHGEAR','HLEGLAS','HMVL','HNDFDS','HNGSNGBEES','HOMEFIRST','HONAUT','HONDAPOWER','HOTELRUGBY','HOVS','HPL','HSCL','HSIL','HTMEDIA','HUBTOWN','HUDCO','HUHTAMAKI','IBMFNIFTY','IBREALEST','IBULHSGFIN','ICEMAKE','ICICI500','ICICIALPLV','ICICIB22','ICICIBANK','ICICIBANKN','ICICIBANKP','ICICIFMCG','ICICIGI','ICICIGOLD','ICICILIQ','ICICILOVOL','ICICIM150','ICICIMCAP','ICICINF100','ICICINIFTY','ICICINV40','ICICINXT50','ICICIPHARM','ICICIPRULI','ICICISENSX','ICICITECH','ICIL','ICRA','IDBI','IDBIGOLD','IDEA','IDFC','IDFCFIRSTB','IDFNIFTYET','IEX','IFBAGRO','IFBIND','IFCI','IFGLEXPOR','IGARASHI','IGL','IGPL','IIFLSEC','IIFLWAM','IMPAL','INCREDIBLE','INDBANK','INDHOTEL','INDIACEM','INDIAGLYCO','INDIAMART','INDIANB','INDIANCARD','INDIANHUME','INDIGO','INDIGOPNTS','INDLMETER','INDNIPPON','INDOCO','INDORAMA','INDOSTAR','INDOTECH','INDOTHAI','INDOWIND','INDRAMEDCO','INDSWFTLAB','INDSWFTLTD','INDTERRAIN','INDUSINDBK','INDUSTOWER','INEOSSTYRO','INFIBEAM','INFOBEAN','INFOMEDIA','INFRABEES','INFY','INGERRAND','INOXLEISUR','INOXWIND','INSECTICID','INSPIRISYS','INTELLECT','INTENTECH','INTLCONV','INVENTURE','IOB','IOC','IOLCP','IPCALAB','IPL','IRB','IRCON','IRCTC','IRFC','IRISDOREME','ISEC','ISFT','ISGEC','ISMTLTD','ITC','ITDC','ITDCEM','ITI','IVC','IVP','IVZINGOLD','IVZINNIFTY','IWEL','IZMO','J&KBANK','JAGRAN','JAGSNPHARM','JAIBALAJI','JAICORPLTD','JAIPURKURT','JAMNAAUTO','JASH','JAYAGROGN','JAYBARMARU','JAYSREETEA','JBCHEPHARM','JBFIND','JBMA','JCHAC','JHS','JINDALPHOT','JINDALPOLY','JINDALSAW','JINDALSTEL','JINDRILL','JINDWORLD','JISLJALEQS','JKCEMENT','JKIL','JKLAKSHMI','JKPAPER','JKTYRE','JMA','JMCPROJECT','JMFINANCIL','JMTAUTOLTD','JOCIL','JPASSOCIAT','JPINFRATEC','JPPOWER','JSL','JSLHISAR','JSWHL','JSWISPL','JSWSTEEL','JTEKTINDIA','JUBLFOOD','JUBLINDS','JUBLINGREA','JUBLPHARMA','JUMPNET','JUNIORBEES','JUSTDIAL','JYOTHYLAB','KABRAEXTRU','KAJARIACER','KAKATCEM','KALPATPOWR','KALYANKJIL','KAMATHOTEL','KAMDHENU','KANANIIND','KANORICHEM','KANPRPLA','KANSAINER','KAPSTON','KARDA','KARMAENG','KARURVYSYA','KAUSHALYA','KAYA','KCP','KCPSUGIND','KDDL','KEC','KEERTI','KEI','KELLTONTEC','KENNAMET','KESORAMIND','KEYFINSERV','KHADIM','KHAICHEM','KHANDSE','KICL','KILITCH','KIMS','KINGFA','KIOCL','KIRIINDUS','KIRLFER','KIRLOSENG','KIRLOSIND','KITEX','KKCL','KMSUGAR','KNRCON','KOKUYOCMLN','KOLTEPATIL','KOPRAN','KOTAKBANK','KOTAKBKETF','KOTAKGOLD','KOTAKIT','KOTAKNIFTY','KOTAKNV40','KOTAKPSUBK','KOTARISUG','KOTHARIPET','KOTHARIPRO','KOVAI','KPIGLOBAL','KPITTECH','KPRMILL','KRBL','KREBSBIO','KRIDHANINF','KRISHANA','KRSNAA','KSB','KSCL','KSL','KTKBANK','KUANTUM','L&TFH','LAGNAM','LALPATHLAB','LAMBODHARA','LAOPALA','LASA','LAURUSLABS','LAXMIMACH','LCCINFOTEC','LEMONTREE','LFIC','LGBBROSLTD','LGBFORGE','LIBAS','LIBERTSHOE','LICHSGFIN','LICNETFGSC','LICNETFN50','LICNETFSEN','LICNFNHGP','LIKHITHA','LINCOLN','LINCPEN','LINDEINDIA','LIQUIDBEES','LIQUIDETF','LODHA','LOKESHMACH','LOTUSEYE','LOVABLE','LPDC','LSIL','LT','LTI','LTTS','LUMAXIND','LUMAXTECH','LUPIN','LUXIND','LXCHEM','LYKALABS','LYPSAGEMS','M&M','M&MFIN','MAANALU','MACPOWER','MADHAV','MADHUCON','MADRASFERT','MAESGETF','MAFANG','MAFSETF','MAGADSUGAR','MAGNUM','MAHABANK','MAHASTEEL','MAHEPC','MAHESHWARI','MAHINDCIE','MAHLIFE','MAHLOG','MAHSCOOTER','MAHSEAMLES','MAITHANALL','MAJESCO','MALUPAPER','MAN50ETF','MANAKALUCO','MANAKCOAT','MANAKSIA','MANAKSTEEL','MANAPPURAM','MANGALAM','MANGCHEFER','MANGLMCEM','MANGTIMBER','MANINDS','MANINFRA','MANUGRAPH','MANXT50','MARALOVER','MARATHON','MARICO','MARINE','MARKSANS','MARUTI','MASFIN','MASPTOP50','MASTEK','MATRIMONY','MAWANASUG','MAXHEALTH','MAXIND','MAXVIL','MAYURUNIQ','MAZDA','MAZDOCK','MBAPL','MBLINFRA','MCDOWELL-N','MCL','MCLEODRUSS','MCX','MEGASOFT','MENONBE','MERCATOR','METROPOLIS','MFL','MFSL','MGEL','MGL','MHRIL','MIDHANI','MINDACORP','MINDAIND','MINDTECK','MINDTREE','MIRCELECTR','MIRZAINT','MITTAL','MMFL','MMP','MMTC','MODISNME','MOGSEC','MOHITIND','MOHOTAIND','MOIL','MOKSH','MOL','MOLDTECH','MOLDTKPAC','MOM100','MOM50','MON100','MONTECARLO','MORARJEE','MOREPENLAB','MOTHERSUMI','MOTILALOFS','MOTOGENFIN','MPHASIS','MPSLTD','MRF','MRO-TEK','MRPL','MSPL','MSTCLTD','MTARTECH','MTEDUCARE','MTNL','MUKTAARTS','MUNJALAU','MUNJALSHOW','MURUDCERA','MUTHOOTCAP','MUTHOOTFIN','NACLIND','NAGAFERT','NAGREEKCAP','NAGREEKEXP','NAHARCAP','NAHARINDUS','NAHARPOLY','NAHARSPING','NAM-INDIA','NATCOPHARM','NATHBIOGEN','NATIONALUM','NATNLSTEEL','NAUKRI','NAVINFLUOR','NAVKARCORP','NAVNETEDUL','NBCC','NBIFIN','NBVENTURES','NCC','NCLIND','NCPSESDL24','NDGL','NDL','NDRAUTO','NDTV','NECCLTD','NECLIFE','NELCAST','NEOGEN','NESCO','NESTLEIND','NETF','NETFCONSUM','NETFDIVOPP','NETFGILT5Y','NETFIT','NETFLTGILT','NETFMID150','NETFNIF100','NETFNV40','NETFPHARMA','NETFSDL26','NETWORK18','NEULANDLAB','NEWGEN','NEXTMEDIA','NFL','NH','NHPC','NIACL','NIBL','NIFTYBEES','NIITLTD','NILASPACES','NILKAMAL','NIPPOBATRY','NIRAJ','NITCO','NITIRAJ','NKIND','NLCINDIA','NMDC','NOCIL','NOIDATOLL','NORBTEAEXP','NOVARTIND','NPBET','NRAIL','NRBBEARING','NSIL','NTL','NTPC','NUCLEUS','NURECA','NUVOCO','NXTDIGITAL','OAL','OBEROIRLTY','OCCL','OFSS','OIL','OMAXAUTO','OMAXE','OMINFRAL','ONELIFECAP','ONEPOINT','ONGC','ONMOBILE','ONWARDTEC','OPTIEMUS','ORBTEXP','ORICONENT','ORIENTABRA','ORIENTALTL','ORIENTBELL','ORIENTCEM','ORIENTELEC','ORIENTHOT','ORIENTLTD','ORIENTPPR','ORISSAMINE','ORTINLAB','OSWALAGRO','PAGEIND','PAISALO','PALASHSECU','PALREDTEC','PANACEABIO','PANACHE','PANAMAPET','PANSARI','PAR','PARACABLES','PARAGMILK','PARAS','PARSVNATH','PASUPTAC','PATELENG','PATINTLOG','PATSPINLTD','PBAINFRA','PCJEWELLER','PDMJEPAPER','PDPL','PDSMFL','PEARLPOLY','PEL','PENIND','PENINLAND','PERSISTENT','PETRONET','PFC','PFIZER','PFOCUS','PFS','PGEL','PGHH','PGHL','PGIL','PHILIPCARB','PHOENIXLTD','PIDILITIND','PIIND','PILANIINVS','PILITA','PIONDIST','PIONEEREMB','PITTIENG','PLASTIBLEN','PNB','PNBGILTS','PNBHOUSING','PNC','PNCINFRA','PODDARHOUS','PODDARMENT','POKARNA','POLYCAB','POLYMED','POLYPLEX','PONNIERODE','POONAWALLA','POWERGRID','POWERINDIA','POWERMECH','PPAP','PPL','PRAENG','PRAKASH','PRAKASHSTL','PRECAM','PRECOT','PRECWIRE','PREMEXPLN','PREMIER','PREMIERPOL','PRESSMN','PRESTIGE','PRICOLLTD','PRIMESECU','PRINCEPIPE','PRITIKAUTO','PRIVISCL','PROZONINTU','PRSMJOHNSN','PSB','PSPPROJECT','PSUBNKBEES','PTC','PTL','PUNJABCHEM','PURVA','PVP','PVR','QGOLDHALF','QNIFTY','QUESS','QUICKHEAL','RADAAN','RADICO','RADIOCITY','RAILTEL','RAIN','RAJESHEXPO','RAJMET','RAJSREESUG','RAJTV','RALLIS','RAMANEWS','RAMASTEEL','RAMCOCEM','RAMCOIND','RAMCOSYS','RAMKY','RANASUG','RANEENGINE','RANEHOLDIN','RATNAMANI','RAYMOND','RBL','RBLBANK','RCF','RCOM','RECLTD','REDINGTON','REFEX','RELAXO','RELIANCE','RELIGARE','REMSONSIND','RENUKA','REPCOHOME','REPL','REPRO','RESPONIND','REVATHI','RGL','RHFL','RHIM','RICOAUTO','RIIL','RITES','RKDL','RKEC','RKFORGE','RML','ROLEXRINGS','ROLLT','ROLTA','ROSSARI','ROSSELLIND','ROUTE','RPGLIFE','RPPINFRA','RPSGVENT','RSSOFTWARE','RSWM','RSYSTEMS','RTNINDIA','RTNPOWER','RUBYMILLS','RUCHI','RUCHIRA','RUPA','RUSHIL','RVHL','RVNL','S&SPOWER','SABEVENTS','SADBHAV','SADBHIN','SAFARI','SAGARDEEP','SAGCEM','SAIL','SAKAR','SAKHTISUG','SAKSOFT','SAKUMA','SALASAR','SALONA','SALSTEEL','SALZERELEC','SAMBHAAV','SANCO','SANDESH','SANDHAR','SANGAMIND','SANGHIIND','SANGHVIMOV','SANOFI','SANSERA','SARDAEN','SARLAPOLY','SASKEN','SASTASUNDR','SATIA','SATIN','SBCL','SBICARD','SBIETFCON','SBIETFIT','SBIETFPB','SBIETFQLTY','SBILIFE','SBIN','SCHAEFFLER','SCHAND','SCHNEIDER','SCI','SDBL','SECURKLOUD','SELAN','SEPOWER','SEQUENT','SERVOTECH','SESHAPAPER','SETCO','SETF10GILT','SETFGOLD','SETFNIF50','SETFNIFBK','SETFNN50','SETUINFRA','SEYAIND','SFL','SGIL','SGL','SHAKTIPUMP','SHALBY','SHALPAINTS','SHANKARA','SHANTIGEAR','SHARDACROP','SHARDAMOTR','SHAREINDIA','SHARIABEES','SHILPAMED','SHIVAMILLS','SHIVATEX','SHK','SHOPERSTOP','SHRADHA','SHREDIGCEM','SHREECEM','SHREEPUSHK','SHREERAMA','SHRENIK','SHREYANIND','SHREYAS','SHRIRAMCIT','SHRIRAMEPC','SHYAMCENT','SHYAMMETL','SHYAMTEL','SIEMENS','SIGIND','SILGO','SILINV','SILLYMONKS','SIMBHALS','SIMPLEXINF','SINTERCOM','SINTEX','SIRCA','SIS','SIYSIL','SJVN','SKFINDIA','SKIL','SKIPPER','SKMEGGPROD','SMARTLINK','SMCGLOBAL','SMLISUZU','SMSLIFE','SMSPHARMA','SNOWMAN','SOBHA','SOLARA','SOLARINDS','SOMATEX','SOMICONVEY','SONACOMS','SONATSOFTW','SORILINFRA','SOTL','SOUTHBANK','SPAL','SPANDANA','SPARC','SPECIALITY','SPENCERS','SPIC','SPICEJET','SPLIL','SPMLINFRA','SPTL','SREEL','SREINFRA','SRF','SRHHYPOLTD','SRIPIPES','SRPL','SRTRANSFIN','STAR','STARCEMENT','STARPAPER','STCINDIA','STEELCITY','STEELXIND','STEL','STERTOOLS','STLTECH','STOVEKRAFT','STYLAMIND','SUBEXLTD','SUBROS','SUDARSCHEM','SUMEETINDS','SUMICHEM','SUMIT','SUMMITSEC','SUNCLAYLTD','SUNDARAM','SUNDARMFIN','SUNDARMHLD','SUNDRMBRAK','SUNDRMFAST','SUNFLAG','SUNPHARMA','SUNTECK','SUNTV','SUPERHOUSE','SUPERSPIN','SUPPETRO','SUPRAJIT','SUPREMEENG','SUPREMEIND','SURANAT&P','SURYALAXMI','SURYAROSNI','SURYODAY','SUTLEJTEX','SUULD','SUVEN','SUVENPHAR','SUVIDHAA','SUZLON','SVPGLOB','SWANENERGY','SWARAJENG','SWELECTES','SWSOLAR','SYMPHONY','SYNGENE','TAINWALCHM','TAJGVK','TAKE','TALBROAUTO','TANLA','TARAPUR','TARC','TARMAT','TASTYBITE','TATACHEM','TATACOFFEE','TATACOMM','TATACONSUM','TATAELXSI','TATAINVEST','TATAMETALI','TATAMOTORS','TATAMTRDVR','TATAPOWER','TATASTEEL','TATASTLLP','TATVA','TBZ','TCI','TCIDEVELOP','TCIEXP','TCIFINANCE','TCNSBRANDS','TCPLPACK','TCS','TDPOWERSYS','TEAMLEASE','TECHM','TECHNOE','TEJASNET','TERASOFT','TEXINFRA','TEXMOPIPES','TEXRAIL','TFCILTD','TGBHOTELS','THANGAMAYL','THEINVEST','THERMAX','THOMASCOOK','THYROCARE','TI','TIDEWATER','TIIL','TIINDIA','TIJARIA','TIL','TIMESGTY','TIMETECHNO','TIMKEN','TINPLATE','TIRUMALCHM','TITAN','TMRVL','TNPETRO','TNPL','TOKYOPLAST','TORNTPHARM','TORNTPOWER','TOTAL','TOUCHWOOD','TPLPLASTEH','TREEHOUSE','TREJHARA','TRENT','TRIDENT','TRIGYN','TRIL','TRITURBINE','TRIVENI','TTKHLTCARE','TTKPRESTIG','TTL','TTML','TV18BRDCST','TVSELECT','TVSMOTOR','TVSSRICHAK','TVTODAY','TVVISION','TWL','UBL','UCALFUEL','UCOBANK','UFLEX','UFO','UGARSUGAR','UGROCAP','UJAAS','UJJIVAN','UJJIVANSFB','ULTRACEMCO','UMANGDAIRY','UMESLTD','UNICHEMLAB','UNIDT','UNIENTER','UNIONBANK','UNITEDTEA','UNIVASTU','UNIVCABLES','UNIVPHOTO','UPL','URJA','USHAMART','UTIAMC','UTIBANKETF','UTINEXT50','UTINIFTETF','UTISENSETF','UTISXN50','UTTAMSTL','UTTAMSUGAR','VADILALIND','VAIBHAVGBL','VAISHALI','VAKRANGEE','VALIANTORG','VARDHACRLC','VARDMNPOLY','VARROC','VASCONEQ','VASWANI','VBL','VEDL','VENKEYS','VENUSREM','VERTOZ','VESUVIUS','VETO','VGUARD','VHL','VIDHIING','VIJAYA','VIJIFIN','VIKASECO','VIKASLIFE','VIKASPROP','VIKASWSP','VIMTALABS','VINATIORGA','VINDHYATEL','VINEETLAB','VINYLINDIA','VIPCLOTHNG','VIPIND','VIPULLTD','VISAKAIND','VISASTEEL','VISHAL','VISHNU','VISHWARAJ','VIVIDHA','VIVIMEDLAB','VLSFINANCE','VMART','VOLTAMP','VOLTAS','VRLLOG','VSSL','VSTIND','VSTTILLERS','VTL','WABAG','WABCOINDIA','WALCHANNAG','WATERBASE','WEBELSOLAR','WEIZMANIND','WELCORP','WELENT','WELINV','WELSPUNIND','WENDT','WESTLIFE','WHEELS','WHIRLPOOL','WILLAMAGOR','WINDLAS','WINDMACHIN','WIPRO','WOCKPHARMA','WONDERLA','WORTH','WSI','WSTCSTPAPR','XCHANGING','XELPMOC','XPROINDIA','YAARII','YESBANK','YUKEN','ZEEL','ZEELEARN','ZENITHEXPO','ZENSARTECH','ZENTEC','ZODIACLOTH','ZOMATO','ZOTA','ZUARI','ZUARIGLOB','ZYDUSWELL','ABAN','ADANITRANS','ADL','AGCNET','AGRITECH','AJMERA','ALPSINDUS','ANANTRAJ','ANTGRAPHIC','ARVSMART','ATGL','BAGFILMS','BLS','BLUECHIP','BLUECOAST','BPL','BURNPUR','BUTTERFLY','BVCL','CALSOFT','CANTABIL','CCCL','CDSL','CGPOWER','CLEDUCATE','CREATIVEYE','DCW','DIGISPICE','DIGJAMLMTD','DISHTV','DRCSYSTEMS','DYNAMATECH','EASEMYTRIP','EUROTEXIND','EXPLEOSOL','GAYAHWS','GFSTEELS','GODHA','GOLDENTOBC','GOLDTECH','GREENPOWER','GTLINFRA','GUJRAFFIA','HAPPSTMNDS','HAVISHA','HEXATRADEX','HGS','HIMATSEIDE','HINDMOTORS','HLVLTD','ICDSLTD','IIFL','IMAGICAA','IMFA','JAYNECOIND','JIKIND','JISLDVREQS','JITFINFRA','JPOLYINVST','JSWENERGY','KALYANIFRG','KAVVERITEL','KECL','KERNEX','KHAITANLTD','KIRLOSBROS','MAHAPEXLTD','MANALIPETC','MASKINVEST','MBECL','MCDHOLDING','MEP','MODIRUBBER','MUKANDLTD','NAZARA','NELCO','NGIL','NILAINFRA','NITINSPIN','OILCOUNTUB','OLECTRA','OMKARCHEM','ORCHPHARMA','PKTEA','PRAJIND','PRAXIS','PROINDIA','RAJRATAN','RELCAPITAL','RELINFRA','ROHITFERRO','ROHLTD','ROML','RPOWER','RUCHINFRA','SANGINITA','SAREGAMA','SATHAISPAT','SCAPDVR','SEAMECLTD','SHAHALLOYS','SHANTI','SHEMAROO','SHIL','SHIVAMAUTO','SHRIPISTON','SICAL','SIL','SITINET','SOMANYCERA','SOUTHWEST','SSWL','SUBCAPCITY','SURANASOL','TATASTLBSL','TECHIN','TEMBO','TFL','THEMISMED','THOMASCOTT','TIPSINDLTD','TIRUPATIFL','TNTELE','TRF','V2RETAIL','WANBURY','WEALTH','WIPL','ZEEMEDIA','ZENITHSTL','AURUM','SIKKO','3IINFOLTD','IITL','BGLOBAL','DALALSTCOM','GANGOTRI','IMPEXFERRO','INTEGRA','JINDCOT','MUKANDENGG','QUINTEGRA','REGENCERAM','SABTN','SPCENET','SPYL','STAMPEDE','VISESHINFO','MEDICAMEQ','HEALTHY','SELMC']

#declaration of lists 
ls = []
ll = []

for ticker in ticker_lis:
    try:
        df = make_time_series(ticker, 49) 
        if df['close'].iloc[-1] > 400:
            try:
                # df['21 Day Moving Price'] = df['close'].rolling(21).mean()
                df['21 Day Moving Price'] = TA.EMA(df, period = 21)
                # df['10 Day Moving Price'] = df['close'].rolling(10).mean()
                df['10 Day Moving Price'] = TA.EMA(df, period = 9)
                df['40 Day Moving Volume'] = df['volume'].rolling(40).mean()
                df['10 Day Moving Volume'] = df['volume'].rolling(10).mean()
                df.dropna(inplace=True)
                print(f"{ticker} is selected ")
                # probable tommorows' lossers
                if df['close'].iloc[-1] > df['21 Day Moving Price'].iloc[-1] and df['close'].iloc[-1] > df['10 Day Moving Price'].iloc[-1]:
                    if df['volume'].iloc[-1] > df['21 Day Moving Volume'].iloc[-1] and df['volume'].iloc[-1] > df['10 Day Moving Volume'].iloc[-1]:
                        ls.append(ticker)
                # elif: #df['close'].iloc[-1] < df['21 Day Moving Price'].iloc[-1] and df['close'].iloc[-1] < df['10 Day Moving Price'].iloc[-1]:
                if df['volume'].iloc[-1] < 0.10* df['21 Day Moving Volume'].iloc[-1] and df['volume'].iloc[-1] < 0.10* df['10 Day Moving Volume'].iloc[-1]:
                    ll.append(ticker)
                # if df['close'].iloc[-1] > df['21 Day Moving Price'].iloc[-1] and df['close'].iloc[-1] < df['10 Day Moving Price'].iloc[-1]:
                #     if df['volume'].iloc[-1] > df['21 Day Moving Volume'].iloc[-1] and df['volume'].iloc[-1] > 3* df['10 Day Moving Volume'].iloc[-1]:
                #         ls.append(ticker)

            except: 
                print('just ignore this')
                
    except:
        print("{ticker} has some problem or might be a new IPO")

final_frame = pd.DataFrame({'TICKER': ls})
final_frame_ = pd.DataFrame({'TICKER': ll})
#here we are considering the a proble profit booking to next day trading there for we are condsidring for short selling, if this is due to some news check and do you analysis 
name = str(dt.date.today()) + '_proble_losser'
#lower volume during a correction is normally means a bigger uptrend is coming, there for do your analyis
name_ = str(dt.date.today()) + '_proble_rev'
#give locaton to save the files 
final_frame.to_excel(f"C:/Users/pillai_amal/NSE_AMAL/Volgainersz/{name}.xlsx")
final_frame_.to_excel(f"C:/Users/pillai_amal/NSE_AMAL/Volgainersz/{name_}.xlsx")
